<?xml version="1.0" encoding="UTF-8"?>
<target:target xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:target="http://fiorano.com/environment/1.0" xsi:schemaLocation="http://fiorano.com/environment/1.0 env.xsd">
  <target:instance name="MTtoXML">
    <target:instance-properties>
      <target:deployment cache="true" nodes="fes"/>
    </target:instance-properties>
    <target:configuration-properties>
      <target:property configurationType="resource" encrypt="false" name="MessageSchema Directory Configuration" type="NamedObject">SwiftMTSchemaDirectory</target:property>
    </target:configuration-properties>
  </target:instance>
  <target:instance name="SwiftTranslator">
    <target:instance-properties>
      <target:deployment cache="true" nodes="fes"/>
    </target:instance-properties>
    <target:configuration-properties>
      <target:property encrypt="false" name="XSL" type="java.lang.String">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>
&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xalan=&quot;http://xml.apache.org/xslt&quot; xmlns:datetime=&quot;http://exslt.org/dates-and-times&quot; xmlns:math=&quot;http://exslt.org/math&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:lxslt=&quot;http://xml.apache.org/xslt&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:java=&quot;http://xml.apache.org/xslt/java&quot; xmlns:set=&quot;http://exslt.org/sets&quot; exclude-result-prefixes=&quot;xalan java lxslt&quot; xmlns:ns6=&quot;urn:iso:std:iso:20022:tech:xsd:head.001.001.02&quot; xmlns:ns2=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:ns1=&quot;urn:swift:xsd:mtmsg.2020&quot; xmlns:ns4=&quot;urn:swift:xsd:envelope&quot; xmlns:ns5=&quot;urn:iso:std:iso:20022:tech:xsd:pacs.009.001.08&quot; xmlns:ns3=&quot;urn:swift:xsd:fin.202.2020&quot; xmlns:MT2MX=&quot;http://xml.apache.org/xslt/java&quot; xmlns:MTtoMX=&quot;http://xml.apache.org/xslt/java&quot; xmlns:MTtoMXUtil=&quot;http://xml.apache.org/xslt/java&quot; xmlns:MX2MT=&quot;http://xml.apache.org/xslt/java&quot; xmlns:MXToMT=&quot;http://xml.apache.org/xslt/java&quot; xmlns:MXtoMT=&quot;http://xml.apache.org/xslt/java&quot; xmlns:QueryGenerator=&quot;QueryGenerator&quot; xmlns:dateConversion=&quot;dateConversion&quot; xmlns:myext=&quot;myext&quot; xmlns:padding=&quot;padding&quot; xmlns:strings=&quot;strings&quot; extension-element-prefixes=&quot;datetime set math MT2MX MTtoMX MTtoMXUtil MX2MT MXToMT MXtoMT QueryGenerator dateConversion myext padding strings&quot;>
  &lt;xsl:import href=&quot;GLOBAL_FUNCLET_PATH&quot;>&lt;/xsl:import>
  &lt;xsl:output method=&quot;xml&quot; indent=&quot;yes&quot; encoding=&quot;UTF-8&quot; xalan:indent-amount=&quot;2&quot; omit-xml-declaration=&quot;no&quot;>&lt;/xsl:output>
  &lt;xsl:variable name=&quot;document&quot; select=&quot;/&quot;>&lt;/xsl:variable>
  &lt;xsl:variable name=&quot;document_IN_PORT&quot; select=&quot;document('IN_PORT')&quot;>&lt;/xsl:variable>
  &lt;xsl:template match=&quot;/&quot;>&lt;xsl:variable name=&quot;Identifier&quot;>&#xD;
 &lt;xsl:choose>&#xD;
                        &lt;xsl:when test=&quot;string-length($document_IN_PORT/ns1:FinMessage/ns1:Block2/ns1:InputIdentifier)&quot;>&#xD;
                            &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block2/ns1:InputIdentifier&quot;>&lt;/xsl:value-of>&#xD;
                              &lt;/xsl:when>&#xD;
							  &lt;xsl:when test=&quot;string-length($document_IN_PORT/ns1:FinMessage/ns1:Block2/ns1:OutputIdentifier)&quot;>&#xD;
                            &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block2/ns1:OutputIdentifier&quot;>&lt;/xsl:value-of>&#xD;
                              &lt;/xsl:when>&#xD;
                            &lt;/xsl:choose>&#xD;
                   &#xD;
 &lt;/xsl:variable>&#xD;
&lt;xsl:variable name=&quot;TSender&quot;>&#xD;
&#xD;
 &lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.generateTSenderTarget(string($Identifier),string($document_IN_PORT/ns1:FinMessage/ns1:Block2/ns1:MessageInputReference/ns1:LTIdentifier),string($document_IN_PORT/ns1:FinMessage/ns1:Block2/ns1:MessageInputReference/ns1:BranchCode),string($document_IN_PORT/ns1:FinMessage/ns1:Block1/ns1:LogicalTerminalAddress))&quot;>&lt;/xsl:value-of>&#xD;
 &#xD;
 &lt;/xsl:variable>&#xD;
&lt;xsl:variable name=&quot;TReceiver&quot;>&#xD;
 &lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.generateTReceiverTarget(string($Identifier),string($document_IN_PORT/ns1:FinMessage/ns1:Block1/ns1:LogicalTerminalAddress),string($document_IN_PORT/ns1:FinMessage/ns1:Block2/ns1:DestinationAddress))&quot;>&lt;/xsl:value-of>&#xD;
 &#xD;
 &lt;/xsl:variable>
    &lt;ns4:Envelope>
      &lt;ns6:AppHdr>
        &lt;ns6:Fr>
          &lt;ns6:FIId>
            &lt;ns6:FinInstnId>
              &lt;ns6:BICFI>
                &lt;xsl:value-of select=&quot;$TSender&quot;>&lt;/xsl:value-of>
              &lt;/ns6:BICFI>
            &lt;/ns6:FinInstnId>
          &lt;/ns6:FIId>
        &lt;/ns6:Fr>
        &lt;ns6:To>
          &lt;ns6:FIId>
            &lt;ns6:FinInstnId>
              &lt;ns6:BICFI>
                &lt;xsl:value-of select=&quot;$TReceiver&quot;>&lt;/xsl:value-of>
              &lt;/ns6:BICFI>
            &lt;/ns6:FinInstnId>
          &lt;/ns6:FIId>
        &lt;/ns6:To>
        &lt;ns6:BizMsgIdr>
          &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F20a/ns3:F20&quot;>&lt;/xsl:value-of>
        &lt;/ns6:BizMsgIdr>
        &lt;ns6:MsgDefIdr>
          &lt;xsl:value-of select=&quot;'pacs.009.001.08'&quot;>&lt;/xsl:value-of>
        &lt;/ns6:MsgDefIdr>
        &lt;ns6:BizSvc>
          &lt;xsl:value-of select=&quot;'swift.cbprplus.02'&quot;>&lt;/xsl:value-of>
        &lt;/ns6:BizSvc>
        &lt;ns6:CreDt>
          &lt;xsl:value-of select=&quot;'9999-12-31T00:00:00+00:00'&quot;>&lt;/xsl:value-of>
        &lt;/ns6:CreDt>
        &lt;ns6:Prty>
          &lt;xsl:variable name=&quot;if0&quot;>
            &lt;xsl:choose>
              &lt;xsl:when test=&quot;(translate($document_IN_PORT/ns1:FinMessage/ns1:Block2/ns1:MessagePriority,'abcdefghijklmnopqrstuvwxyz','ABCDEFGHIJKLMNOPQRSTUVWXYZ'))=('U')&quot;>
                &lt;xsl:value-of select=&quot;'HIGH'&quot;>&lt;/xsl:value-of>
              &lt;/xsl:when>
              &lt;xsl:otherwise>
                &lt;xsl:value-of select=&quot;'NORM'&quot;>&lt;/xsl:value-of>
              &lt;/xsl:otherwise>
            &lt;/xsl:choose>
          &lt;/xsl:variable>
          &lt;xsl:value-of select=&quot;$if0&quot;>&lt;/xsl:value-of>
        &lt;/ns6:Prty>
      &lt;/ns6:AppHdr>
      &lt;ns5:Document>
        &lt;ns5:FICdtTrf>
          &lt;ns5:GrpHdr>
            &lt;ns5:MsgId>
              &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F20a/ns3:F20&quot;>&lt;/xsl:value-of>
            &lt;/ns5:MsgId>
            &lt;ns5:CreDtTm>
              &lt;xsl:value-of select=&quot;'9999-12-31T00:00:00+00:00'&quot;>&lt;/xsl:value-of>
            &lt;/ns5:CreDtTm>
            &lt;ns5:NbOfTxs>
              &lt;xsl:value-of select=&quot;'1'&quot;>&lt;/xsl:value-of>
            &lt;/ns5:NbOfTxs>
            &lt;ns5:SttlmInf>&lt;xsl:variable name=&quot;METAFCT002&quot;>&#xD;
 &lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.METAFCT002(&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F53a),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F54a),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F53a/ns3:F53B),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F53a/ns3:F53B/ns3:PartyIdentifier),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F53a/ns3:F53B/ns3:Location),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F53a/ns3:F53A),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F53a/ns3:F53A/ns3:PartyIdentifier),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F53a/ns3:F53A/ns3:IdentifierCode),&#xD;
 string($TSender),&#xD;
 string($TReceiver),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F53a/ns3:F53D),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F54a/ns3:F54A),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F54a/ns3:F54A/ns3:IdentifierCode),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F54a/ns3:F54A/ns3:PartyIdentifier),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F54a/ns3:F54B),&#xD;
 string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F54a/ns3:F54D),&#xD;
 string(null))&quot;>&lt;/xsl:value-of> &#xD;
 &#xD;
 &lt;/xsl:variable>&#xD;
 &lt;xsl:variable name=&quot;SettlementMethod&quot;>&#xD;
 &lt;xsl:value-of select=&quot;substring-before($METAFCT002, ':::')&quot;/>&#xD;
 &lt;/xsl:variable>&#xD;
&lt;xsl:variable name=&quot;settlemtAccount&quot;>&#xD;
 &lt;xsl:value-of select=&quot;substring-before(substring-after($METAFCT002, ':::'),':::') &quot;/>&#xD;
 &lt;/xsl:variable>&#xD;
&lt;xsl:variable name=&quot;InstructionForNextAgent53&quot;>&#xD;
 &lt;xsl:value-of select=&quot;substring-before(substring-after(substring-after($METAFCT002, ':::'), ':::'),':::') &quot;/>&#xD;
 &lt;/xsl:variable>&#xD;
&lt;xsl:variable name=&quot;InstructionForNextAgent54&quot;>&#xD;
 &lt;xsl:value-of select=&quot;substring-after(substring-after(substring-after($METAFCT002, ':::'), ':::'),':::') &quot;/>&#xD;
 &lt;/xsl:variable>
              &lt;ns5:SttlmMtd>
                &lt;xsl:value-of select=&quot;$SettlementMethod&quot;>&lt;/xsl:value-of>
              &lt;/ns5:SttlmMtd>
              &lt;ns5:SttlmAcct>
                &lt;ns5:Id>
                  &lt;ns5:Othr>
                    &lt;ns5:Id>
                      &lt;xsl:value-of select=&quot;$settlemtAccount&quot;>&lt;/xsl:value-of>
                    &lt;/ns5:Id>
                  &lt;/ns5:Othr>
                &lt;/ns5:Id>
              &lt;/ns5:SttlmAcct>
            &lt;/ns5:SttlmInf>
          &lt;/ns5:GrpHdr>
          &lt;ns5:CdtTrfTxInf>
            &lt;ns5:PmtId>
              &lt;ns5:InstrId>
                &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F20a/ns3:F20&quot;>&lt;/xsl:value-of>
              &lt;/ns5:InstrId>
              &lt;ns5:EndToEndId>
                &lt;xsl:variable name=&quot;if1&quot;>
                  &lt;xsl:choose>
                    &lt;xsl:when test=&quot;not(MT2MX:com.fiorano.funclet.MTtoMX.isInputNullorBlank(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F21a/ns3:F21)))&quot;>
                      &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F21a/ns3:F21&quot;>&lt;/xsl:value-of>
                    &lt;/xsl:when>
                    &lt;xsl:when test=&quot;(java:_getStringProperty($_TIF_MESSAGE_, 'is200'))=('true')&quot;>
                      &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F20a/ns3:F20&quot;>&lt;/xsl:value-of>
                    &lt;/xsl:when>
                  &lt;/xsl:choose>
                &lt;/xsl:variable>
                &lt;xsl:value-of select=&quot;$if1&quot;>&lt;/xsl:value-of>
              &lt;/ns5:EndToEndId>
              &lt;ns5:UETR>
                &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block3/ns1:F121&quot;>&lt;/xsl:value-of>
              &lt;/ns5:UETR>
            &lt;/ns5:PmtId>
            &lt;ns5:PmtTpInf>
              &lt;ns5:ClrChanl>
                &lt;xsl:variable name=&quot;if2&quot;>
                  &lt;xsl:choose>
                    &lt;xsl:when test=&quot;(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:PartyIdentifier,'//RT') or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:PartyIdentifier,'//FW') or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56D/ns3:PartyIdentifier,'//RT') or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:PartyIdentifier,'//RT') or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:PartyIdentifier,'//FW') or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57D/ns3:PartyIdentifier,'//RT') or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58A/ns3:PartyIdentifier,'//RT') or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58A/ns3:PartyIdentifier,'//FW') or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58D/ns3:PartyIdentifier,'//RT'))&quot;>
                      &lt;xsl:value-of select=&quot;'RTGS'&quot;>&lt;/xsl:value-of>
                    &lt;/xsl:when>
                  &lt;/xsl:choose>
                &lt;/xsl:variable>
                &lt;xsl:value-of select=&quot;$if2&quot;>&lt;/xsl:value-of>
              &lt;/ns5:ClrChanl>
              &lt;ns5:SvcLvl>
                &lt;ns5:Cd>
                  &lt;xsl:variable name=&quot;if3&quot;>
                    &lt;xsl:choose>
                      &lt;xsl:when test=&quot;starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block3/ns1:F111,'00')&quot;>
                        &lt;xsl:value-of select=&quot;concat('G',$document_IN_PORT/ns1:FinMessage/ns1:Block3/ns1:F111)&quot;>&lt;/xsl:value-of>
                      &lt;/xsl:when>
                      &lt;xsl:otherwise>
                        &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block3/ns1:F111&quot;>&lt;/xsl:value-of>
                      &lt;/xsl:otherwise>
                    &lt;/xsl:choose>
                  &lt;/xsl:variable>
                  &lt;xsl:value-of select=&quot;$if3&quot;>&lt;/xsl:value-of>
                &lt;/ns5:Cd>
              &lt;/ns5:SvcLvl>
            &lt;/ns5:PmtTpInf>
            &lt;ns5:IntrBkSttlmAmt>
              &lt;xsl:attribute name=&quot;Ccy&quot;>
                &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F32a/ns3:F32A/ns3:Currency&quot;>&lt;/xsl:value-of>
              &lt;/xsl:attribute>
              &lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.mt2MXAmount(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F32a/ns3:F32A/ns3:Amount))&quot;>&lt;/xsl:value-of>
            &lt;/ns5:IntrBkSttlmAmt>
            &lt;ns5:IntrBkSttlmDt>
              &lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.MT_To_MXDate(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F32a/ns3:F32A/ns3:Date))&quot;>&lt;/xsl:value-of>
            &lt;/ns5:IntrBkSttlmDt>
            &lt;ns5:SttlmTmIndctn>
              &lt;ns5:DbtDtTm>&lt;xsl:for-each select = &quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F13a/ns3:F13C&quot;> &#xD;
                  &lt;xsl:choose>&#xD;
                  &lt;xsl:when test=&quot;(ns3:Code)=('SNDTIME')&quot;>&#xD;
                   &lt;xsl:value-of select=&quot;concat('0001-01-01T',substring(ns3:TimeIndication,1,2),':',substring(ns3:TimeIndication,3),':00',ns3:Sign,substring(ns3:TimeOffset,1,2),':',substring(ns3:TimeOffset,3))&quot;>&lt;/xsl:value-of>&#xD;
               &lt;/xsl:when>&#xD;
                  &lt;/xsl:choose>&#xD;
				 &lt;/xsl:for-each>&lt;/ns5:DbtDtTm>
              &lt;ns5:CdtDtTm>&lt;xsl:for-each select = &quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F13a/ns3:F13C&quot;> &#xD;
              &lt;xsl:choose>&#xD;
               &lt;xsl:when test=&quot;(ns3:Code)=('RNCTIME')&quot;>&#xD;
                &lt;xsl:value-of select=&quot;concat('0001-01-01T',substring(ns3:TimeIndication,1,2),':',substring(ns3:TimeIndication,3),':00',ns3:Sign,substring(ns3:TimeOffset,1,2),':',substring(ns3:TimeOffset,3))&quot;>&lt;/xsl:value-of>&#xD;
               &lt;/xsl:when>&#xD;
              &lt;/xsl:choose>&#xD;
			 &lt;/xsl:for-each>&lt;/ns5:CdtDtTm>
            &lt;/ns5:SttlmTmIndctn>
            &lt;ns5:SttlmTmReq>
              &lt;ns5:CLSTm>&lt;xsl:for-each select = &quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F13a/ns3:F13C&quot;> &#xD;
              &lt;xsl:choose>&#xD;
               &lt;xsl:when test=&quot;(ns3:Code)=('CLSTIME')&quot;>&#xD;
                &lt;xsl:value-of select=&quot;concat(substring(ns3:TimeIndication,1,2),':',substring(ns3:TimeIndication,3),':00',ns3:Sign,substring(ns3:TimeOffset,1,2),':',substring(ns3:TimeOffset,3))&quot;>&lt;/xsl:value-of>&#xD;
               &lt;/xsl:when>&#xD;
              &lt;/xsl:choose>&#xD;
			 &lt;/xsl:for-each>&lt;/ns5:CLSTm>
              &lt;ns5:TillTm>&lt;xsl:for-each select = &quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F13a/ns3:F13C&quot;> &#xD;
              &lt;xsl:choose>&#xD;
               &lt;xsl:when test=&quot;(ns3:Code)=('TILTIME')&quot;>&#xD;
                &lt;xsl:value-of select=&quot;concat(substring(ns3:TimeIndication,1,2),':',substring(ns3:TimeIndication,3),':00',ns3:Sign,substring(ns3:TimeOffset,1,2),':',substring(ns3:TimeOffset,3))&quot;>&lt;/xsl:value-of>&#xD;
               &lt;/xsl:when>&#xD;
              &lt;/xsl:choose>&#xD;
			 &lt;/xsl:for-each>&lt;/ns5:TillTm>
              &lt;ns5:FrTm>&lt;xsl:for-each select = &quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F13a/ns3:F13C&quot;> &#xD;
              &lt;xsl:choose>&#xD;
               &lt;xsl:when test=&quot;(ns3:Code)=('FROTIME')&quot;>&#xD;
                &lt;xsl:value-of select=&quot;concat(substring(ns3:TimeIndication,1,2),':',substring(ns3:TimeIndication,3),':00',ns3:Sign,substring(ns3:TimeOffset,1,2),':',substring(ns3:TimeOffset,3))&quot;>&lt;/xsl:value-of>&#xD;
               &lt;/xsl:when>&#xD;
              &lt;/xsl:choose>&#xD;
			 &lt;/xsl:for-each>&lt;/ns5:FrTm>
              &lt;ns5:RjctTm>&lt;xsl:for-each select = &quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F13a/ns3:F13C&quot;> &#xD;
              &lt;xsl:choose>&#xD;
               &lt;xsl:when test=&quot;(ns3:Code)=('REJTIME')&quot;>&#xD;
                &lt;xsl:value-of select=&quot;concat(substring(ns3:TimeIndication,1,2),':',substring(ns3:TimeIndication,3),':00',ns3:Sign,substring(ns3:TimeOffset,1,2),':',substring(ns3:TimeOffset,3))&quot;>&lt;/xsl:value-of>&#xD;
               &lt;/xsl:when>&#xD;
              &lt;/xsl:choose>&#xD;
			 &lt;/xsl:for-each>&lt;/ns5:RjctTm>
            &lt;/ns5:SttlmTmReq>
            &lt;ns5:PrvsInstgAgt1>
              &lt;ns5:FinInstnId>
                &lt;ns5:BICFI>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT72INS_To_MXAgent_Agent1_BICFI(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:BICFI>
                &lt;ns5:Nm>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT72INS_To_MXAgent_Agent1_Name(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:Nm>
                &lt;ns5:PstlAdr>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;ResultantPostalAddress&quot;>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT72INS_To_MXAgent_Agent1_Address(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&#xD;
&#xD;
 &lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:call-template name=&quot;tokenize&quot;>&#xD;
&lt;xsl:with-param name=&quot;text&quot; select=&quot;$ResultantPostalAddress&quot;/>&#xD;
&lt;xsl:with-param name=&quot;separator&quot; select=&quot;$LineSeparator&quot;/>&#xD;
&lt;/xsl:call-template>
                  &lt;ns5:AdrLine>&lt;!-- User code starts here -->&lt;/ns5:AdrLine>
                &lt;/ns5:PstlAdr>
              &lt;/ns5:FinInstnId>
            &lt;/ns5:PrvsInstgAgt1>
            &lt;ns5:PrvsInstgAgt2>
              &lt;ns5:FinInstnId>
                &lt;ns5:BICFI>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT72INS_To_MXAgent_Agent2_BICFI(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:BICFI>
                &lt;ns5:Nm>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT72INS_To_MXAgent_Agent2_Name(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:Nm>
                &lt;ns5:PstlAdr>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;ResultantPostalAddress&quot;>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT72INS_To_MXAgent_Agent2_Address(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&#xD;
&#xD;
 &lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:call-template name=&quot;tokenize&quot;>&#xD;
&lt;xsl:with-param name=&quot;text&quot; select=&quot;$ResultantPostalAddress&quot;/>&#xD;
&lt;xsl:with-param name=&quot;separator&quot; select=&quot;$LineSeparator&quot;/>&#xD;
&lt;/xsl:call-template>
                  &lt;ns5:AdrLine>&lt;!-- User code starts here -->&lt;/ns5:AdrLine>
                &lt;/ns5:PstlAdr>
              &lt;/ns5:FinInstnId>
            &lt;/ns5:PrvsInstgAgt2>
            &lt;ns5:PrvsInstgAgt3>
              &lt;ns5:FinInstnId>
                &lt;ns5:BICFI>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT72INS_To_MXAgent_Agent3_BICFI(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:BICFI>
                &lt;ns5:Nm>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT72INS_To_MXAgent_Agent3_Name(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:Nm>
                &lt;ns5:PstlAdr>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;ResultantPostalAddress&quot;>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT72INS_To_MXAgent_Agent3_Address(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&#xD;
&#xD;
 &lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:call-template name=&quot;tokenize&quot;>&#xD;
&lt;xsl:with-param name=&quot;text&quot; select=&quot;$ResultantPostalAddress&quot;/>&#xD;
&lt;xsl:with-param name=&quot;separator&quot; select=&quot;$LineSeparator&quot;/>&#xD;
&lt;/xsl:call-template>
                  &lt;ns5:AdrLine>&lt;!-- User code starts here -->&lt;/ns5:AdrLine>
                &lt;/ns5:PstlAdr>
              &lt;/ns5:FinInstnId>
            &lt;/ns5:PrvsInstgAgt3>
            &lt;ns5:InstgAgt>
              &lt;ns5:FinInstnId>
                &lt;ns5:BICFI>
                  &lt;xsl:value-of select=&quot;$TSender&quot;>&lt;/xsl:value-of>
                &lt;/ns5:BICFI>
              &lt;/ns5:FinInstnId>
            &lt;/ns5:InstgAgt>
            &lt;ns5:InstdAgt>
              &lt;ns5:FinInstnId>
                &lt;ns5:BICFI>
                  &lt;xsl:value-of select=&quot;$TReceiver&quot;>&lt;/xsl:value-of>
                &lt;/ns5:BICFI>
              &lt;/ns5:FinInstnId>
            &lt;/ns5:InstdAgt>
            &lt;ns5:IntrmyAgt1>&lt;xsl:variable name=&quot;F56D_NameAndAddress&quot;> &#xD;
 &lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56D/ns3:NameAndAddress/ns3:Line&quot;> &#xD;
 &lt;xsl:value-of select=&quot;concat(text(),'\n')&quot;>&lt;/xsl:value-of>&#xD;
	&lt;/xsl:for-each>&#xD;
	 &lt;/xsl:variable>
              &lt;ns5:FinInstnId>
                &lt;ns5:BICFI>
                  &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:IdentifierCode&quot;>&lt;/xsl:value-of>
                &lt;/ns5:BICFI>
                &lt;ns5:ClrSysMmbId>
                  &lt;ns5:MmbId>
                    &lt;xsl:variable name=&quot;if4&quot;>
                      &lt;xsl:choose>
                        &lt;xsl:when test=&quot;(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:PartyIdentifier,'//') and not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:PartyIdentifier,'//CH')) and not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:PartyIdentifier,'//FW')) and not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:PartyIdentifier,'//RT')))&quot;>
                          &lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.mt2MXClearingIdentifier(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>
                        &lt;/xsl:when>
                      &lt;/xsl:choose>
                    &lt;/xsl:variable>
                    &lt;xsl:value-of select=&quot;$if4&quot;>&lt;/xsl:value-of>
                  &lt;/ns5:MmbId>
                &lt;/ns5:ClrSysMmbId>
                &lt;ns5:Nm>
                  &lt;xsl:value-of select=&quot;substring-before($F56D_NameAndAddress,'\n')&quot;>&lt;/xsl:value-of>
                &lt;/ns5:Nm>
                &lt;ns5:PstlAdr>&lt;xsl:call-template name=&quot;Address_Template&quot;>
								&lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($F56D_NameAndAddress, '\n')&quot;/>
&lt;/xsl:call-template>
                  &lt;ns5:AdrLine>
                    &lt;xsl:variable name=&quot;if4&quot;>
                      &lt;xsl:choose>
                        &lt;xsl:when test=&quot;(not(string-length(substring-after($F56D_NameAndAddress,'\n'))) and string-length(substring-before($F56D_NameAndAddress,'\n')))&quot;>
                          &lt;xsl:value-of select=&quot;'NOTPROVIDED'&quot;>&lt;/xsl:value-of>
                        &lt;/xsl:when>
                      &lt;/xsl:choose>
                    &lt;/xsl:variable>
                    &lt;xsl:value-of select=&quot;$if4&quot;>&lt;/xsl:value-of>
                  &lt;/ns5:AdrLine>&lt;/ns5:PstlAdr>
              &lt;/ns5:FinInstnId>
            &lt;/ns5:IntrmyAgt1>
            &lt;ns5:IntrmyAgt1Acct>
              &lt;ns5:Id>
                &lt;ns5:Othr>
                  &lt;ns5:Id>&lt;xsl:variable name=&quot;if18&quot;>&#xD;
                      &lt;xsl:choose>&#xD;
                        &lt;xsl:when test=&quot;string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:PartyIdentifier)&quot;>&#xD;
                          &lt;xsl:variable name=&quot;if19&quot;>&#xD;
                            &lt;xsl:choose>&#xD;
                              &lt;xsl:when test=&quot;(not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:PartyIdentifier,'//CH')) or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:PartyIdentifier,'//'))&quot;>&#xD;
                                &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.mt2MXFinancialInstitutionAccount(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56A/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>&#xD;
                              &lt;/xsl:when>&#xD;
                            &lt;/xsl:choose>&#xD;
                          &lt;/xsl:variable>&#xD;
                          &lt;xsl:value-of select=&quot;$if19&quot;>&lt;/xsl:value-of>&#xD;
                        &lt;/xsl:when>&#xD;
                        &lt;xsl:when test=&quot;string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56C/ns3:PartyIdentifier)&quot;>&#xD;
                          &lt;xsl:variable name=&quot;if20&quot;>&#xD;
                            &lt;xsl:choose>&#xD;
                              &lt;xsl:when test=&quot;(not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56C/ns3:PartyIdentifier,'//CH')) or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56C/ns3:PartyIdentifier,'//'))&quot;>&#xD;
							   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.mt2MXFinancialInstitutionAccount(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56C/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>&#xD;
                              &lt;/xsl:when>&#xD;
                            &lt;/xsl:choose>&#xD;
                          &lt;/xsl:variable>&#xD;
                          &lt;xsl:value-of select=&quot;$if20&quot;>&lt;/xsl:value-of>&#xD;
                        &lt;/xsl:when>&#xD;
                        &lt;xsl:when test=&quot;string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56D/ns3:PartyIdentifier)&quot;>&#xD;
                          &lt;xsl:variable name=&quot;if21&quot;>&#xD;
                            &lt;xsl:choose>&#xD;
                              &lt;xsl:when test=&quot;(not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56D/ns3:PartyIdentifier,'//CH')) or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56D/ns3:PartyIdentifier,'//'))&quot;>&#xD;
							   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.mt2MXFinancialInstitutionAccount(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F56a/ns3:F56D/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>&#xD;
                              &lt;/xsl:when>&#xD;
                            &lt;/xsl:choose>&#xD;
                          &lt;/xsl:variable>&#xD;
                          &lt;xsl:value-of select=&quot;$if21&quot;>&lt;/xsl:value-of>&#xD;
                        &lt;/xsl:when>&#xD;
                      &lt;/xsl:choose>&#xD;
                    &lt;/xsl:variable>&#xD;
                    &lt;xsl:value-of select=&quot;$if18&quot;>&lt;/xsl:value-of>&lt;/ns5:Id>
                &lt;/ns5:Othr>
              &lt;/ns5:Id>
            &lt;/ns5:IntrmyAgt1Acct>
            &lt;ns5:IntrmyAgt2>
              &lt;ns5:FinInstnId>
                &lt;ns5:BICFI>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent2BICFI(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:BICFI>
                &lt;ns5:ClrSysMmbId>
                  &lt;ns5:ClrSysId>
                    &lt;ns5:Cd>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent2ClearSysCode(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:Cd>
                  &lt;/ns5:ClrSysId>
                  &lt;ns5:MmbId>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent2ClearSysId(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:MmbId>
                &lt;/ns5:ClrSysMmbId>
                &lt;ns5:Nm>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent2Name(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:Nm>
                &lt;ns5:PstlAdr>
                  &lt;ns5:TwnNm>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent2TownName(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:TwnNm>
                  &lt;ns5:Ctry>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent2CountryCode(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:Ctry>
                  &lt;ns5:AdrLine>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent2AddressLine(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:AdrLine>
                &lt;/ns5:PstlAdr>
              &lt;/ns5:FinInstnId>
            &lt;/ns5:IntrmyAgt2>
            &lt;ns5:IntrmyAgt3>
              &lt;ns5:FinInstnId>
                &lt;ns5:BICFI>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent3BICFI(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:BICFI>
                &lt;ns5:ClrSysMmbId>
                  &lt;ns5:ClrSysId>
                    &lt;ns5:Cd>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent3ClearSysCode(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:Cd>
                  &lt;/ns5:ClrSysId>
                  &lt;ns5:MmbId>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent3ClearSysId(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:MmbId>
                &lt;/ns5:ClrSysMmbId>
                &lt;ns5:Nm>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent3Name(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:Nm>
                &lt;ns5:PstlAdr>
                  &lt;ns5:TwnNm>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent3TownName(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:TwnNm>
                  &lt;ns5:Ctry>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent3CountryCode(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:Ctry>
                  &lt;ns5:AdrLine>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MXField72NewCodeWords_InterAgent3AddressLine(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&lt;/ns5:AdrLine>
                &lt;/ns5:PstlAdr>
              &lt;/ns5:FinInstnId>
            &lt;/ns5:IntrmyAgt3>
            &lt;ns5:Dbtr>&lt;xsl:variable name=&quot;F52D_NameAndAddress&quot;> &#xD;
 &lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F52a/ns3:F52D/ns3:NameAndAddress/ns3:Line&quot;> &#xD;
 &lt;xsl:value-of select=&quot;concat(text(),'\n')&quot;>&lt;/xsl:value-of>&#xD;
	&lt;/xsl:for-each>&#xD;
	 &lt;/xsl:variable>
              &lt;ns5:FinInstnId>
                &lt;ns5:BICFI>
                  &lt;xsl:variable name=&quot;if5&quot;>
                    &lt;xsl:choose>
                      &lt;xsl:when test=&quot;not(string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F52a))&quot;>
                        &lt;xsl:value-of select=&quot;$TSender&quot;>&lt;/xsl:value-of>
                      &lt;/xsl:when>
                      &lt;xsl:when test=&quot;string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F52a/ns3:F52A)&quot;>
                        &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F52a/ns3:F52A/ns3:IdentifierCode&quot;>&lt;/xsl:value-of>
                      &lt;/xsl:when>
                    &lt;/xsl:choose>
                  &lt;/xsl:variable>
                  &lt;xsl:value-of select=&quot;$if5&quot;>&lt;/xsl:value-of>
                &lt;/ns5:BICFI>
                &lt;ns5:ClrSysMmbId>
                  &lt;ns5:MmbId>
                    &lt;xsl:variable name=&quot;if6&quot;>
                      &lt;xsl:choose>
                        &lt;xsl:when test=&quot;(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F52a/ns3:F52A/ns3:PartyIdentifier,'//') and not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F52a/ns3:F52A/ns3:PartyIdentifier,'//CH')) and not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F52a/ns3:F52A/ns3:PartyIdentifier,'//FW')))&quot;>
                          &lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.mt2MXClearingIdentifier(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F52a/ns3:F52A/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>
                        &lt;/xsl:when>
                      &lt;/xsl:choose>
                    &lt;/xsl:variable>
                    &lt;xsl:value-of select=&quot;$if6&quot;>&lt;/xsl:value-of>
                  &lt;/ns5:MmbId>
                &lt;/ns5:ClrSysMmbId>
                &lt;ns5:Nm>
                  &lt;xsl:value-of select=&quot;substring-before($F52D_NameAndAddress,'\n')&quot;>&lt;/xsl:value-of>
                &lt;/ns5:Nm>
                &lt;ns5:PstlAdr>&lt;xsl:call-template name=&quot;Address_Template&quot;>
                    &lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($F52D_NameAndAddress, '\n')&quot;/>
                &lt;/xsl:call-template>
                  &lt;ns5:AdrLine>
                    &lt;xsl:variable name=&quot;if7&quot;>
                      &lt;xsl:choose>
                        &lt;xsl:when test=&quot;(not(string-length(substring-after($F52D_NameAndAddress,'\n'))) and string-length(substring-before($F52D_NameAndAddress,'\n')))&quot;>
                          &lt;xsl:value-of select=&quot;'NOTPROVIDED'&quot;>&lt;/xsl:value-of>
                        &lt;/xsl:when>
                      &lt;/xsl:choose>
                    &lt;/xsl:variable>
                    &lt;xsl:value-of select=&quot;$if7&quot;>&lt;/xsl:value-of>
                  &lt;/ns5:AdrLine>&lt;/ns5:PstlAdr>
              &lt;/ns5:FinInstnId>
            &lt;/ns5:Dbtr>
            &lt;ns5:DbtrAcct>
              &lt;ns5:Id>
                &lt;ns5:Othr>
                  &lt;ns5:Id>
                    &lt;xsl:variable name=&quot;if7&quot;>
                      &lt;xsl:choose>
                        &lt;xsl:when test=&quot;(not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F52a/ns3:F52A/ns3:PartyIdentifier,'//')) or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F52a/ns3:F52A/ns3:PartyIdentifier,'//CH'))&quot;>
                          &lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.mt2MXFinancialInstitutionAccount(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F52a/ns3:F52A/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>
                        &lt;/xsl:when>
                      &lt;/xsl:choose>
                    &lt;/xsl:variable>
                    &lt;xsl:value-of select=&quot;$if7&quot;>&lt;/xsl:value-of>
                  &lt;/ns5:Id>
                &lt;/ns5:Othr>
              &lt;/ns5:Id>
            &lt;/ns5:DbtrAcct>
            &lt;ns5:CdtrAgt>&lt;xsl:variable name=&quot;F57D_NameAndAddress&quot;> &#xD;
 &lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57D/ns3:NameAndAddress/ns3:Line&quot;> &#xD;
 &lt;xsl:value-of select=&quot;concat(text(),'\n')&quot;>&lt;/xsl:value-of>&#xD;
	&lt;/xsl:for-each>&#xD;
	 &lt;/xsl:variable>
              &lt;ns5:FinInstnId>
                &lt;ns5:BICFI>
                  &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:IdentifierCode&quot;>&lt;/xsl:value-of>
                &lt;/ns5:BICFI>
                &lt;ns5:ClrSysMmbId>
                  &lt;ns5:MmbId>
                    &lt;xsl:variable name=&quot;if8&quot;>
                      &lt;xsl:choose>
                        &lt;xsl:when test=&quot;(not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:PartyIdentifier,'//')) and starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:PartyIdentifier,'//CH') and starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:PartyIdentifier,'//FW') and starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:PartyIdentifier,'//RT'))&quot;>
                          &lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.mt2MXClearingIdentifier(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>
                        &lt;/xsl:when>
                      &lt;/xsl:choose>
                    &lt;/xsl:variable>
                    &lt;xsl:value-of select=&quot;$if8&quot;>&lt;/xsl:value-of>
                  &lt;/ns5:MmbId>
                &lt;/ns5:ClrSysMmbId>
                &lt;ns5:Nm>
                  &lt;xsl:value-of select=&quot;substring-before($F57D_NameAndAddress,'\n')&quot;>&lt;/xsl:value-of>
                &lt;/ns5:Nm>
                &lt;ns5:PstlAdr>&lt;xsl:call-template name=&quot;Address_Template&quot;>&#xD;
                    &lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($F57D_NameAndAddress, '\n')&quot;/>&#xD;
                &lt;/xsl:call-template>&lt;/ns5:PstlAdr>
              &lt;/ns5:FinInstnId>
            &lt;/ns5:CdtrAgt>
            &lt;ns5:CdtrAgtAcct>
              &lt;ns5:Id>
                &lt;ns5:Othr>
                  &lt;ns5:Id>&lt;xsl:variable name=&quot;if27&quot;>&#xD;
                      &lt;xsl:choose>&#xD;
                        &lt;xsl:when test=&quot;string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:PartyIdentifier)&quot;>&#xD;
                          &lt;xsl:variable name=&quot;if28&quot;>&#xD;
                            &lt;xsl:choose>&#xD;
                              &lt;xsl:when test=&quot;(not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:PartyIdentifier,'//CH')) or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:PartyIdentifier,'//'))&quot;>&#xD;
                                &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.mt2MXFinancialInstitutionAccount(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57A/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>&#xD;
                              &lt;/xsl:when>&#xD;
                            &lt;/xsl:choose>&#xD;
                          &lt;/xsl:variable>&#xD;
                          &lt;xsl:value-of select=&quot;$if28&quot;>&lt;/xsl:value-of>&#xD;
                        &lt;/xsl:when>&#xD;
                        &lt;xsl:when test=&quot;string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57B/ns3:PartyIdentifier)&quot;>&#xD;
                          &lt;xsl:variable name=&quot;if29&quot;>&#xD;
                            &lt;xsl:choose>&#xD;
                              &lt;xsl:when test=&quot;(not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57B/ns3:PartyIdentifier,'//CH')) or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57B/ns3:PartyIdentifier,'//'))&quot;>&#xD;
                                &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.mt2MXFinancialInstitutionAccount(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57B/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>&#xD;
                              &lt;/xsl:when>&#xD;
                            &lt;/xsl:choose>&#xD;
                          &lt;/xsl:variable>&#xD;
                          &lt;xsl:value-of select=&quot;$if29&quot;>&lt;/xsl:value-of>&#xD;
                        &lt;/xsl:when>&#xD;
                        &lt;xsl:when test=&quot;string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57D/ns3:PartyIdentifier)&quot;>&#xD;
                          &lt;xsl:variable name=&quot;if30&quot;>&#xD;
                            &lt;xsl:choose>&#xD;
                              &lt;xsl:when test=&quot;(not(starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57D/ns3:PartyIdentifier,'//CH')) or starts-with($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57D/ns3:PartyIdentifier,'//'))&quot;>&#xD;
                                &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.mt2MXFinancialInstitutionAccount(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F57a/ns3:F57D/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>&#xD;
                              &lt;/xsl:when>&#xD;
                            &lt;/xsl:choose>&#xD;
                          &lt;/xsl:variable>&#xD;
                          &lt;xsl:value-of select=&quot;$if30&quot;>&lt;/xsl:value-of>&#xD;
                        &lt;/xsl:when>&#xD;
                      &lt;/xsl:choose>&#xD;
                    &lt;/xsl:variable>&#xD;
                    &lt;xsl:value-of select=&quot;$if27&quot;>&lt;/xsl:value-of>&lt;/ns5:Id>
                &lt;/ns5:Othr>
              &lt;/ns5:Id>
            &lt;/ns5:CdtrAgtAcct>
            &lt;ns5:Cdtr>
              &lt;ns5:FinInstnId>
                &lt;ns5:BICFI>
                  &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58A/ns3:IdentifierCode&quot;>&lt;/xsl:value-of>
                &lt;/ns5:BICFI>
                &lt;ns5:Nm>
                  &lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58D/ns3:NameAndAddress/ns3:Line&quot;>&lt;/xsl:value-of>
                &lt;/ns5:Nm>
                &lt;ns5:PstlAdr>&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58D/ns3:NameAndAddress/ns3:Line&quot;>&#xD;
	&lt;xsl:if test=&quot;position()&amp;gt;('1')&quot;>
                  &lt;ns5:AdrLine>&lt;xsl:value-of select=&quot;.&quot;>&lt;/xsl:value-of>&lt;/ns5:AdrLine>&lt;/xsl:if>&#xD;
&lt;/xsl:for-each>&#xD;
&lt;ns2:AdrLine>&#xD;
                  &lt;xsl:variable name=&quot;if3&quot;>&#xD;
                    &lt;xsl:choose>&#xD;
                      &lt;xsl:when test=&quot;MT2MX:com.fiorano.funclet.MTtoMX.isInputNullorBlank(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58D/ns3:NameAndAddress/ns3:Line[2]))  and (not(string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58A/ns3:IdentifierCode))) and (string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58D/ns3:NameAndAddress/ns3:Line[1]))&quot;>&#xD;
                        &lt;xsl:value-of select=&quot;'NOTPROVIDED'&quot;>&lt;/xsl:value-of>&#xD;
                      &lt;/xsl:when>&#xD;
                    &lt;/xsl:choose>&#xD;
                  &lt;/xsl:variable>&#xD;
                  &lt;xsl:value-of select=&quot;$if3&quot;>&lt;/xsl:value-of>&#xD;
                &lt;/ns2:AdrLine>&lt;/ns5:PstlAdr>
              &lt;/ns5:FinInstnId>
            &lt;/ns5:Cdtr>
            &lt;ns5:CdtrAcct>
              &lt;ns5:Id>
                &lt;ns5:Othr>
                  &lt;ns5:Id>&lt;xsl:variable name=&quot;if34&quot;>&#xD;
                      &lt;xsl:choose>&#xD;
                        &lt;xsl:when test=&quot;string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58A/ns3:PartyIdentifier)&quot;>&#xD;
                          &lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.mt2MXFinancialInstitutionAccount(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58A/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>&#xD;
                        &lt;/xsl:when>&#xD;
                        &lt;xsl:when test=&quot;string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58D/ns3:PartyIdentifier)&quot;>&#xD;
                          &lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.mt2MXFinancialInstitutionAccount(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F58a/ns3:F58D/ns3:PartyIdentifier))&quot;>&lt;/xsl:value-of>&#xD;
                        &lt;/xsl:when>&#xD;
                      &lt;/xsl:choose>&#xD;
                    &lt;/xsl:variable>&#xD;
                    &lt;xsl:value-of select=&quot;$if34&quot;>&lt;/xsl:value-of>&lt;/ns5:Id>
                &lt;/ns5:Othr>
              &lt;/ns5:Id>
            &lt;/ns5:CdtrAcct>&lt;xsl:variable name=&quot;LineSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFLINE'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;ResultantAddress&quot;>&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MX_InstructionForCreditorAgent2_202COV(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&#xD;
   &#xD;
 &lt;/xsl:variable>&#xD;
 &#xD;
 &lt;xsl:call-template name=&quot;tokenize4&quot;>&#xD;
&lt;xsl:with-param name=&quot;text&quot; select=&quot;$ResultantAddress&quot;/>&#xD;
&lt;/xsl:call-template>
            &lt;ns5:InstrForCdtrAgt>&lt;!-- User code starts here -->&lt;/ns5:InstrForCdtrAgt>&lt;xsl:variable name=&quot;VarSeparator&quot;>&#xD;
	&lt;xsl:value-of select=&quot;'ENDOFFVAR'&quot;/>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;AppendedPostalAddress&quot;>&#xD;
		&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative1&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Code&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;./ns3:Narrative2&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$VarSeparator&quot;/>&#xD;
			&lt;xsl:value-of select=&quot;$LineSeparator&quot;/>&#xD;
		&lt;/xsl:for-each>&#xD;
&lt;/xsl:variable>&#xD;
&#xD;
&lt;xsl:variable name=&quot;ResultantAddress&quot;>&#xD;
   &lt;xsl:value-of select=&quot;MTtoMX:com.fiorano.funclet.MTtoMX.MT_To_MX_InstructionForNextAgent2_202CORE(string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F53a/ns3:F53A/ns3:IdentifierCode),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F54a/ns3:F54A/ns3:IdentifierCode),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code),string($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative),string($AppendedPostalAddress), string($LineSeparator), string($VarSeparator))&quot;>&lt;/xsl:value-of>&#xD;
   &#xD;
 &lt;/xsl:variable>&#xD;
 &#xD;
 &lt;xsl:call-template name=&quot;tokenize2&quot;>&#xD;
&lt;xsl:with-param name=&quot;text&quot; select=&quot;$ResultantAddress&quot;/>&#xD;
&lt;xsl:with-param name=&quot;separator&quot; select=&quot;$LineSeparator&quot;/>&#xD;
&lt;/xsl:call-template>
            &lt;ns5:InstrForNxtAgt>&lt;!-- User code starts here -->&lt;/ns5:InstrForNxtAgt>
            &lt;ns5:RmtInf>
              &lt;ns5:Ustrd>&lt;xsl:variable name=&quot;Limiter&quot;>
&lt;xsl:value-of select=&quot;'ENDOFOUTPUT'&quot;>&lt;/xsl:value-of>
&lt;/xsl:variable>
&lt;xsl:variable name=&quot;Line1Code&quot;>
&lt;xsl:value-of select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code&quot;>&lt;/xsl:value-of>
&lt;/xsl:variable>

&lt;xsl:variable name=&quot;MT72&quot;>
 

&lt;xsl:choose>
&lt;xsl:when test=&quot;(string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6/ns3:Narrative1) and (not(string-length($document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6/ns3:Narrative2))))&quot;>
&lt;xsl:value-of select=&quot;concat('/',$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Code,'/',$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Line1/ns3:Narrative, 'ENDOFLINE')&quot;>&lt;/xsl:value-of>
&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;> 
 &lt;xsl:value-of select=&quot;concat('//',./ns3:Narrative1,'ENDOFLINE')&quot;>&lt;/xsl:value-of>
 	&lt;/xsl:for-each>

&lt;/xsl:when>
&lt;xsl:otherwise>

&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>

&lt;xsl:choose>
&lt;xsl:when test=&quot;((./ns3:Code)=($Line1Code))&quot;>
&lt;xsl:value-of select=&quot;concat('ENDOFOUTPUT','/',./ns3:Code,'/')&quot;>&lt;/xsl:value-of>
&lt;xsl:choose>
&lt;xsl:when test=&quot;(string-length(./ns3:Narrative2))&quot;>
&lt;xsl:value-of select=&quot;concat(./ns3:Narrative2,'ENDOFLINE')&quot;>&lt;/xsl:value-of>

&lt;/xsl:when>
&lt;/xsl:choose>
&lt;/xsl:when>
&lt;/xsl:choose>

&lt;/xsl:for-each>


&lt;xsl:for-each select=&quot;$document_IN_PORT/ns1:FinMessage/ns1:Block4/ns3:Document/ns3:MT202/ns3:F72a/ns3:F72/ns3:NarrativeStructuredFormat/ns3:Lines2to6&quot;>
&lt;xsl:choose>
&lt;xsl:when test=&quot;(string-length(./ns3:Narrative1))&quot;>
 &lt;xsl:value-of select=&quot;concat('//',./ns3:Narrative1,'ENDOFLINE')&quot;>&lt;/xsl:value-of>
&lt;/xsl:when>
&lt;/xsl:choose>
&lt;/xsl:for-each>


&lt;/xsl:otherwise>
&lt;/xsl:choose>
  &lt;/xsl:variable>


&lt;xsl:choose>
&lt;xsl:when test=&quot;contains($MT72,$Limiter)&quot;>
&lt;xsl:variable name=&quot;Resultant&quot;>
&lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.LastIndexSubstring(string($MT72),string($Limiter))&quot;>&lt;/xsl:value-of>
&lt;/xsl:variable>
&lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.MT_To_MXBNF_TSU_RI(string($Resultant))&quot;>&lt;/xsl:value-of>

&lt;/xsl:when>
&lt;xsl:otherwise>
&lt;xsl:value-of select=&quot;MT2MX:com.fiorano.funclet.MTtoMX.MT_To_MXBNF_TSU_RI(string($MT72))&quot;>&lt;/xsl:value-of>

&lt;/xsl:otherwise>

&lt;/xsl:choose>&lt;/ns5:Ustrd>
            &lt;/ns5:RmtInf>
          &lt;/ns5:CdtTrfTxInf>
        &lt;/ns5:FICdtTrf>
      &lt;/ns5:Document>
    &lt;/ns4:Envelope>
  &lt;/xsl:template>&lt;xsl:template name=&quot;Address_Template&quot;>&#xD;
 &lt;xsl:param name=&quot;text&quot; select=&quot;.&quot;/>&#xD;
 &lt;xsl:param name=&quot;separator&quot; select=&quot;'\n'&quot;/>&#xD;
        &lt;xsl:choose>&#xD;
            &lt;xsl:when test=&quot;not(contains($text, $separator))&quot;>&#xD;
                  &lt;ns5:AdrLine>&#xD;
                    &lt;xsl:value-of select=&quot;normalize-space($text)&quot;/>&#xD;
                &lt;/ns5:AdrLine>&#xD;
            &lt;/xsl:when>&#xD;
            &lt;xsl:otherwise>&#xD;
               &lt;ns5:AdrLine>&#xD;
                    &lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $separator))&quot;/>&#xD;
               &lt;/ns5:AdrLine>&#xD;
                &lt;xsl:call-template name=&quot;Address_Template&quot;>&#xD;
                    &lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($text, $separator)&quot;/>&#xD;
                &lt;/xsl:call-template>&#xD;
            &lt;/xsl:otherwise>&#xD;
        &lt;/xsl:choose>&#xD;
&lt;/xsl:template>&#xD;
&lt;xsl:template name=&quot;tokenize&quot;>&#xD;
 &lt;xsl:param name=&quot;text&quot; select=&quot;.&quot;/>&#xD;
 &lt;xsl:param name=&quot;separator&quot; select=&quot;'ENDOFFLINE'&quot;/>&#xD;
        &lt;xsl:choose>&#xD;
		&lt;xsl:when test=&quot;not(string-length($text))&quot;>&#xD;
		&lt;/xsl:when>&#xD;
            &lt;xsl:when test=&quot;(not(contains($text, $separator))) &quot;>&#xD;
                &lt;ns5:AdrLine>&#xD;
                    &lt;xsl:value-of select=&quot;normalize-space($text)&quot;/>&#xD;
                &lt;/ns5:AdrLine>&#xD;
				&#xD;
            &lt;/xsl:when>&#xD;
            &lt;xsl:when test=&quot;((contains($text, $separator))) &quot;>&#xD;
               &lt;ns5:AdrLine>&#xD;
                    &lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $separator))&quot;/>&#xD;
               &lt;/ns5:AdrLine>&#xD;
                &lt;xsl:call-template name=&quot;tokenize&quot;>&#xD;
                    &lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($text, $separator)&quot;/>&#xD;
                &lt;/xsl:call-template>&#xD;
            &lt;/xsl:when>&#xD;
        &lt;/xsl:choose>&#xD;
&lt;/xsl:template>&#xD;
&#xD;
&lt;xsl:template name=&quot;tokenize2&quot;>&#xD;
 &lt;xsl:param name=&quot;text&quot; select=&quot;.&quot;/>&#xD;
 &lt;xsl:param name=&quot;separator&quot; select=&quot;'ENDOFFLINE'&quot;/>&#xD;
        &lt;xsl:choose>&#xD;
		&lt;xsl:when test=&quot;not(string-length($text))&quot;>&#xD;
		&lt;/xsl:when>&#xD;
            &lt;xsl:when test=&quot;(not(contains($text, $separator))) &quot;>&#xD;
			&lt;ns5:InstrForNxtAgt>&#xD;
                &lt;ns5:InstrInf>&#xD;
                    &lt;xsl:value-of select=&quot;normalize-space($text)&quot;/>&#xD;
                &lt;/ns5:InstrInf>&#xD;
				&lt;/ns5:InstrForNxtAgt>&#xD;
				&#xD;
            &lt;/xsl:when>&#xD;
            &lt;xsl:when test=&quot;((contains($text, $separator))) &quot;>&#xD;
			&lt;ns5:InstrForNxtAgt>&#xD;
               &lt;ns5:InstrInf>&#xD;
                    &lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $separator))&quot;/>&#xD;
               &lt;/ns5:InstrInf>&#xD;
			   &lt;/ns5:InstrForNxtAgt>&#xD;
                &lt;xsl:call-template name=&quot;tokenize2&quot;>&#xD;
                    &lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($text, $separator)&quot;/>&#xD;
                &lt;/xsl:call-template>&#xD;
            &lt;/xsl:when>&#xD;
        &lt;/xsl:choose>&#xD;
&lt;/xsl:template>&#xD;
&#xD;
 &lt;xsl:template name=&quot;tokenize3&quot;>&#xD;
 &lt;xsl:param name=&quot;text&quot; select=&quot;.&quot;/>&#xD;
 &lt;xsl:param name=&quot;LineSeparator&quot; select=&quot;'ENDOFFLINE'&quot;/>&#xD;
 &lt;xsl:param name=&quot;VarSeparator&quot; select=&quot;'ENDOFFVAR'&quot;/>&#xD;
        &lt;xsl:choose>&#xD;
		&lt;xsl:when test=&quot;not(string-length($text))&quot;>&#xD;
		&lt;/xsl:when>&#xD;
            &lt;xsl:when test=&quot;not(contains($text, $LineSeparator))&quot;>&#xD;
			&lt;ns5:Othr>&#xD;
				&lt;ns5:Id>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Id>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:SchmeNm>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&lt;/ns5:SchmeNm>&#xD;
&#xD;
				&lt;xsl:variable name=&quot;Issurval&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($Cdval, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:Issr>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Issurval, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Issr>&#xD;
                &lt;/ns5:Othr>&#xD;
            &lt;/xsl:when>&#xD;
           &lt;xsl:when test=&quot;((contains($text, $LineSeparator))) &quot;>&#xD;
              &#xD;
			  &lt;ns5:Othr>&#xD;
				&lt;ns5:Id>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Id>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval1&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:SchmeNm>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval1, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&lt;/ns5:SchmeNm>&#xD;
&#xD;
				&lt;xsl:variable name=&quot;Issurval1&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($Cdval1, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:Issr>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Issurval1, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Issr>&#xD;
				&lt;/ns5:Othr>&#xD;
                &lt;xsl:call-template name=&quot;tokenize3&quot;>&#xD;
                    &lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($text, $LineSeparator)&quot;/>&#xD;
                &lt;/xsl:call-template>&#xD;
            &lt;/xsl:when>&#xD;
        &lt;/xsl:choose>&#xD;
&lt;/xsl:template>&#xD;
&#xD;
&#xD;
 &lt;xsl:template name=&quot;tokenize4&quot;>&#xD;
 &lt;xsl:param name=&quot;text&quot; select=&quot;.&quot;/>&#xD;
 &lt;xsl:param name=&quot;LineSeparator&quot; select=&quot;'ENDOFFLINE'&quot;/>&#xD;
 &lt;xsl:param name=&quot;VarSeparator&quot; select=&quot;'ENDOFFVAR'&quot;/>&#xD;
        &lt;xsl:choose>&#xD;
		&lt;xsl:when test=&quot;not(string-length($text))&quot;>&#xD;
		&lt;/xsl:when>&#xD;
            &lt;xsl:when test=&quot;not(contains($text, $LineSeparator))&quot;>&#xD;
			&lt;ns5:InstrForCdtrAgt>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:InstrInf>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:InstrInf>&#xD;
&#xD;
                &lt;/ns5:InstrForCdtrAgt>&#xD;
            &lt;/xsl:when>&#xD;
           &lt;xsl:when test=&quot;((contains($text, $LineSeparator))) &quot;>&#xD;
              &#xD;
			  &lt;ns5:InstrForCdtrAgt>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval1&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:InstrInf>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval1, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:InstrInf>&#xD;
&#xD;
				&lt;/ns5:InstrForCdtrAgt>&#xD;
                &lt;xsl:call-template name=&quot;tokenize4&quot;>&#xD;
                    &lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($text, $LineSeparator)&quot;/>&#xD;
                &lt;/xsl:call-template>&#xD;
            &lt;/xsl:when>&#xD;
        &lt;/xsl:choose>&#xD;
&lt;/xsl:template>&#xD;
&#xD;
&#xD;
 &lt;xsl:template name=&quot;tokenize5&quot;>&#xD;
 &lt;xsl:param name=&quot;text&quot; select=&quot;.&quot;/>&#xD;
 &lt;xsl:param name=&quot;LineSeparator&quot; select=&quot;'ENDOFFLINE'&quot;/>&#xD;
 &lt;xsl:param name=&quot;VarSeparator&quot; select=&quot;'ENDOFFVAR'&quot;/>&#xD;
        &lt;xsl:choose>&#xD;
		&lt;xsl:when test=&quot;not(string-length($text))&quot;>&#xD;
		&lt;/xsl:when>&#xD;
            &lt;xsl:when test=&quot;not(contains($text, $LineSeparator))&quot;>&#xD;
			&lt;ns5:SvcLvl>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:Prtry>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Prtry>&#xD;
&#xD;
                &lt;/ns5:SvcLvl>&#xD;
            &lt;/xsl:when>&#xD;
           &lt;xsl:when test=&quot;((contains($text, $LineSeparator))) &quot;>&#xD;
              &#xD;
			  &lt;ns5:SvcLvl>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval1&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:Prtry>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval1, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Prtry>&#xD;
&#xD;
				&lt;/ns5:SvcLvl>&#xD;
                &lt;xsl:call-template name=&quot;tokenize5&quot;>&#xD;
                    &lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($text, $LineSeparator)&quot;/>&#xD;
                &lt;/xsl:call-template>&#xD;
            &lt;/xsl:when>&#xD;
        &lt;/xsl:choose>&#xD;
&lt;/xsl:template>&#xD;
&#xD;
 &lt;xsl:template name=&quot;tokenize6&quot;>&#xD;
 &lt;xsl:param name=&quot;text&quot; select=&quot;.&quot;/>&#xD;
 &lt;xsl:param name=&quot;LineSeparator&quot; select=&quot;'ENDOFFLINE'&quot;/>&#xD;
 &lt;xsl:param name=&quot;VarSeparator&quot; select=&quot;'ENDOFFVAR'&quot;/>&#xD;
        &lt;xsl:choose>&#xD;
		&lt;xsl:when test=&quot;not(string-length($text))&quot;>&#xD;
		&lt;/xsl:when>&#xD;
            &lt;xsl:when test=&quot;not(contains($text, $LineSeparator))&quot;>&#xD;
			&lt;ns5:LclInstrm>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:Prtry>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Prtry>&#xD;
&#xD;
                &lt;/ns5:LclInstrm>&#xD;
            &lt;/xsl:when>&#xD;
           &lt;xsl:when test=&quot;((contains($text, $LineSeparator))) &quot;>&#xD;
              &#xD;
			  &lt;ns5:LclInstrm>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval1&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:Prtry>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval1, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Prtry>&#xD;
&#xD;
				&lt;/ns5:LclInstrm>&#xD;
                &lt;xsl:call-template name=&quot;tokenize6&quot;>&#xD;
                    &lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($text, $LineSeparator)&quot;/>&#xD;
                &lt;/xsl:call-template>&#xD;
            &lt;/xsl:when>&#xD;
        &lt;/xsl:choose>&#xD;
&lt;/xsl:template>&#xD;
&#xD;
 &lt;xsl:template name=&quot;tokenize7&quot;>&#xD;
 &lt;xsl:param name=&quot;text&quot; select=&quot;.&quot;/>&#xD;
 &lt;xsl:param name=&quot;LineSeparator&quot; select=&quot;'ENDOFFLINE'&quot;/>&#xD;
 &lt;xsl:param name=&quot;VarSeparator&quot; select=&quot;'ENDOFFVAR'&quot;/>&#xD;
        &lt;xsl:choose>&#xD;
		&lt;xsl:when test=&quot;not(string-length($text))&quot;>&#xD;
		&lt;/xsl:when>&#xD;
            &lt;xsl:when test=&quot;not(contains($text, $LineSeparator))&quot;>&#xD;
			&lt;ns5:CtgyPurp>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:Prtry>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Prtry>&#xD;
&#xD;
                &lt;/ns5:CtgyPurp>&#xD;
            &lt;/xsl:when>&#xD;
           &lt;xsl:when test=&quot;((contains($text, $LineSeparator))) &quot;>&#xD;
              &#xD;
			  &lt;ns5:CtgyPurp>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval1&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:Prtry>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval1, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Prtry>&#xD;
&#xD;
				&lt;/ns5:CtgyPurp>&#xD;
                &lt;xsl:call-template name=&quot;tokenize7&quot;>&#xD;
                    &lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($text, $LineSeparator)&quot;/>&#xD;
                &lt;/xsl:call-template>&#xD;
            &lt;/xsl:when>&#xD;
        &lt;/xsl:choose>&#xD;
&lt;/xsl:template>&#xD;
&#xD;
&#xD;
&#xD;
 &lt;xsl:template name=&quot;tokenize8&quot;>&#xD;
 &lt;xsl:param name=&quot;text&quot; select=&quot;.&quot;/>&#xD;
 &lt;xsl:param name=&quot;LineSeparator&quot; select=&quot;'ENDOFFLINE'&quot;/>&#xD;
 &lt;xsl:param name=&quot;VarSeparator&quot; select=&quot;'ENDOFFVAR'&quot;/>&#xD;
        &lt;xsl:choose>&#xD;
		&lt;xsl:when test=&quot;not(string-length($text))&quot;>&#xD;
		&lt;/xsl:when>&#xD;
            &lt;xsl:when test=&quot;not(contains($text, $LineSeparator))&quot;>&#xD;
			&lt;ns5:Purp>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:Prtry>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Prtry>&#xD;
&#xD;
                &lt;/ns5:Purp>&#xD;
            &lt;/xsl:when>&#xD;
           &lt;xsl:when test=&quot;((contains($text, $LineSeparator))) &quot;>&#xD;
              &#xD;
			  &lt;ns5:Purp>&#xD;
				&lt;ns5:Cd>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($text, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Cd>&#xD;
				&#xD;
				&lt;xsl:variable name=&quot;Cdval1&quot;>&#xD;
				&lt;xsl:value-of select=&quot;substring-after($text, $VarSeparator)&quot;/>&#xD;
				&lt;/xsl:variable>&#xD;
				&#xD;
				&lt;ns5:Prtry>&#xD;
				&lt;xsl:value-of select=&quot;normalize-space(substring-before($Cdval1, $VarSeparator))&quot;/>&#xD;
				&lt;/ns5:Prtry>&#xD;
&#xD;
				&lt;/ns5:Purp>&#xD;
                &lt;xsl:call-template name=&quot;tokenize8&quot;>&#xD;
                    &lt;xsl:with-param name=&quot;text&quot; select=&quot;substring-after($text, $LineSeparator)&quot;/>&#xD;
                &lt;/xsl:call-template>&#xD;
            &lt;/xsl:when>&#xD;
        &lt;/xsl:choose>&#xD;
&lt;/xsl:template>
&lt;!--The list of parameters defined by user-->
  &lt;xsl:param name=&quot;_TIF_MESSAGE_&quot;>&lt;/xsl:param>
&lt;!--The list of Extensions defined by user-->
&lt;/xsl:stylesheet></target:property>
      <target:property encrypt="false" name="XSLT Engine" type="java.lang.String">Xalan</target:property>
      <target:property encrypt="false" name="Transformation Class Name" type="java.lang.String"></target:property>
    </target:configuration-properties>
  </target:instance>
</target:target>